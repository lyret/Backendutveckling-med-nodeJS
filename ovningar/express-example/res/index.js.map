{
  "version": 3,
  "sources": ["../index.ts", "../router.ts"],
  "sourcesContent": ["import express from \"express\";\nimport { createResourceRouter } from \"./router\";\n\nconst port = 3000;\nconst server = express();\n\n/*\n/events\n/participants\n/organizers\n*/\n\nserver.use(express.json());\n\nserver.use(\"/events\", createResourceRouter(\"events\", false));\nserver.use(\"/participants\", createResourceRouter(\"participants\", false));\nserver.use(\"/organizers\", createResourceRouter(\"organizers\", true));\n\nserver.listen(port, () => {\n\tconsole.log(`Server is running on port ${port}`);\n});\n", "import express from \"express\";\n\nconst resources = {\n\tevents: [],\n\tparticipants: [],\n\torganizers: [],\n};\n\n/** Returns a Express router for a REST resource of the given name */\nexport function createResourceRouter(resourceName, requiresApiKey) {\n\tconst router = express.Router();\n\n\tif (requiresApiKey) {\n\t\trouter.use((req, res, next) => {\n\t\t\tconsole.log(\"key is:\", req.query.apiKey);\n\n\t\t\tif (!req.query.apiKey) {\n\t\t\t\tthrow { status: 401 };\n\t\t\t} else if (req.query.apiKey != \"bananget\") {\n\t\t\t\tthrow { status: 403 };\n\t\t\t}\n\t\t\tnext();\n\t\t});\n\t}\n\n\trouter.get(\"/\", (req, res) => {\n\t\tres.send(resources[resourceName]);\n\t});\n\trouter.get(\"/:id\", (req, res) => {\n\t\tconst id = Number(req.params.id);\n\t\tif (!resources[resourceName][id]) {\n\t\t\tthrow { status: 404 };\n\t\t}\n\t\tres.status(200);\n\t\tres.send(resources[resourceName][id]);\n\t});\n\trouter.post(\"/\", (req, res) => {\n\t\t// Skapa ny resurs\n\t\tconst newResource = req.body;\n\t\tnewResource.id = String(Math.floor(Math.random() * 1000));\n\n\t\t// validera resursen\n\t\tif (!newResource.name.length) {\n\t\t\tthrow { status: 402, message: \"No name given\" };\n\t\t}\n\t\t// Lagra den nya resusen\n\t\tresources[resourceName].push(newResource);\n\n\t\t// Ge tillbaka resursen\n\t\tres.status(201);\n\t\tres.send(newResource);\n\t});\n\trouter.patch(\"/:id\", (req, res) => {\n\t\tconst id = Number(req.params.id);\n\n\t\tresources[resourceName][id] = {\n\t\t\t...resources[resourceName][id],\n\t\t\t...req.body,\n\t\t};\n\n\t\tres.status(200);\n\t\tres.send(resources[resourceName]);\n\t});\n\trouter.delete(\"/:id\", (req, res) => {\n\t\tconst id = Number(req.params.id);\n\t\tresources[resourceName][id] = undefined;\n\t\tresources[resourceName] = resources[resourceName].filter(\n\t\t\t(event) => !!event\n\t\t);\n\t\tres.status(200);\n\t\tres.send(resources[resourceName]);\n\t});\n\n\trouter.use((err, req, res, next) => {\n\t\tconsole.error(\"I got the error\");\n\t\tif (err.status) {\n\t\t\tres.status(err.status);\n\t\t} else {\n\t\t\tres.status(500);\n\t\t}\n\t\tif (err.message) {\n\t\t\tres.send({ message: err.message });\n\t\t} else {\n\t\t\tres.send({ message: \"\" });\n\t\t}\n\t});\n\n\treturn router;\n}\n"],
  "mappings": "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",
  "names": ["express", "express"]
}
